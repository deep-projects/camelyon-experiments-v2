batches:
- inputs:
    mask: tumor_001.xml
    mask_dir:
      class: Directory
      connector:
        access: {archiveFormat: zip, url: 'ftp://parrot.genomics.cn/gigadb/pub/10.5524/100001_101000/100439/CAMELYON16/training//lesion_annotations.zip'}
        command: red-connector-ftp-archive
    pixel_spacing: 0.0002439
    slide:
      class: File
      connector:
        access: {url: 'ftp://parrot.genomics.cn/gigadb/pub/10.5524/100001_101000/100439/CAMELYON16/training//tumor/tumor_001.tif'}
        command: red-connector-ftp
  outputs:
    tiles:
      class: File
      connector:
        access:
          auth: {password: '{{ssh_password}}', username: '{{ssh_username}}'}
          filePath: camelyon-experiments-v2/tiles/tumor_001.hdf5
          host: avocado01.f4.htw-berlin.de
        command: red-connector-ssh
- inputs:
    mask: tumor_002.xml
    mask_dir:
      class: Directory
      connector:
        access: {archiveFormat: zip, url: 'ftp://parrot.genomics.cn/gigadb/pub/10.5524/100001_101000/100439/CAMELYON16/training//lesion_annotations.zip'}
        command: red-connector-ftp-archive
    pixel_spacing: 0.0002439
    slide:
      class: File
      connector:
        access: {url: 'ftp://parrot.genomics.cn/gigadb/pub/10.5524/100001_101000/100439/CAMELYON16/training//tumor/tumor_002.tif'}
        command: red-connector-ftp
  outputs:
    tiles:
      class: File
      connector:
        access:
          auth: {password: '{{ssh_password}}', username: '{{ssh_username}}'}
          filePath: camelyon-experiments-v2/tiles/tumor_002.hdf5
          host: avocado01.f4.htw-berlin.de
        command: red-connector-ssh
- inputs:
    pixel_spacing: 0.0002439
    slide:
      class: File
      connector:
        access: {url: 'ftp://parrot.genomics.cn/gigadb/pub/10.5524/100001_101000/100439/CAMELYON16/training//normal/normal_001.tif'}
        command: red-connector-ftp
  outputs:
    tiles:
      class: File
      connector:
        access:
          auth: {password: '{{ssh_password}}', username: '{{ssh_username}}'}
          filePath: camelyon-experiments-v2/tiles/normal_001.hdf5
          host: avocado01.f4.htw-berlin.de
        command: red-connector-ssh
- inputs:
    pixel_spacing: 0.0002439
    slide:
      class: File
      connector:
        access: {url: 'ftp://parrot.genomics.cn/gigadb/pub/10.5524/100001_101000/100439/CAMELYON16/training//normal/normal_002.tif'}
        command: red-connector-ftp
  outputs:
    tiles:
      class: File
      connector:
        access:
          auth: {password: '{{ssh_password}}', username: '{{ssh_username}}'}
          filePath: camelyon-experiments-v2/tiles/normal_002.hdf5
          host: avocado01.f4.htw-berlin.de
        command: red-connector-ssh
cli:
  baseCommand: [camelyon-utils, slide-tiles]
  class: CommandLineTool
  cwlVersion: v1.0
  doc: CAMELYON Utils is a set of tools to process slides of the CAMELYON image database.
  inputs:
    mask:
      doc: PATH to mask file in CAMELYON XML format. If this is not given it will
        done a simple tissue segmentation with an otsu algorithm.
      inputBinding: {prefix: --mask}
      type: string?
    mask_dir:
      doc: PATH to a directory containing mask files. This PATH will be prepended
        to a relative --mask PATH, if --mask is specified. Otherwise --mask-dir is
        ignored.
      inputBinding: {prefix: --mask-dir}
      type: Directory?
    pixel_spacing:
      doc: 'The pixel spacing that you want to use to get the HDF5-File. A lower number
        means a higher resolution. In CAMEYLON16 the first scanner have the following
        values: [0.0002439 0.00048781 0.00097561 0.00195122 0.00390244 0.00780488
        0.0156098 0.0312195 0.062439 0.124878] and the second scanner: [0.00022727
        0.00045454 0.00090909 0.00181818 0.00363636 0.00727273 0.0145455 0.0290909
        0.0581818], If you want two layers at the highest resolution good values would
        be 0.0002439 and 0.00048781.'
      inputBinding: {prefix: --pixel-spacing}
      type: float?
    slide:
      doc: Path to SLIDEFILE in  OpenSlide tif format.
      inputBinding: {position: 0}
      type: File
  outputs:
    tiles:
      doc: HDF5 file containing tiles as numpy arrays generated from slide.
      outputBinding: {glob: tiles.hdf5}
      type: File
container:
  engine: docker
  settings:
    image: {url: 'docker.io/deepprojects/camelyon-utils:0.5'}
    ram: 8192
execution:
  engine: ccagency
  settings:
    access:
      auth: {password: '{{agency_password}}', username: '{{agency_username}}'}
      url: https://agency.f4.htw-berlin.de/cc
    batchConcurrencyLimit: 16
    retryIfFailed: true
redVersion: '8'
